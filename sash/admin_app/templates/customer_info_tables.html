
{% extends "admin_base.html" %}
{% load static %}
{% block content %}
{% include "modal.html" %}
<div class="content">
    {% include "alert.html" %}
        <div class="row">
          <div class="col-md-12">
            <div class="card">
              <div class="card-header">
                <h4 class="card-title">Customer Orders</h4>
              </div>
              <div class="card-body">
                  <!-- <button class="action px-3 btn btn-info float-right" data-id="% url 'admin_product_create' %"><i class="fa fa-plus pr-2"></i>Product</button> -->
                  <table class="table table-striped table-bordered" id="customer-info-table">
                    <thead class="text-primary">
                      <th>
                        Customer Name
                      </th>
                      <th>
                        Address
                      </th>
                      <th>
                        Order
                      </th>
                      <th>
                        Total Price
                      </th>
                      <th>
                        Contact Number
                      </th>
                      <th class="no-sort text-center">
                        Actions
                      </th>
                    </thead>
                    <tbody>
                    {% for customer in customer_info %}
                      <tr>
                        <td>
                          {{ customer.first_name }} {{ customer.middle_initial }}{% if customer.middle_initial %}.{% endif %} {{ customer.last_name }}
                        </td>
                        <td>
                          {{ customer.address }}
                        </td>
                        <td>
                          {% for order in customer.final_order.orders.all %}
                          <li>
                                {{ order.product }} ({{ order.quantity }}) ₱{{ order.total_price }}
                          </li>
                          {% endfor %}
                        </td>
                        <td>
                         ₱{{ customer.final_order.overall_price }}
                        </td>
                        <td>
                          {{ customer.contact_number }}
                        </td>
                        <td class="text-center">
                          <button class="action btn btn-info py-2 px-3" data-id="% url 'admin_product_update' product.pk %"><i class="fa fa-edit"></i></button>
                          <button class="action btn btn-danger py-2 px-3" data-id="% url 'admin_product_delete' product.pk %"><i class="fa fa-trash"></i></button>
                        </td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
              </div>
            </div>
          </div>
        </div>
      </div>
      <script src="{% static '/assets/dataTables/js/jquery.dataTables.min.js' %}"></script>
      <link href="{% static '/assets/dataTables/css/dataTables.material.min.css' %}" rel="stylesheet">
      <link href="{% static '/assets/dataTables/css/material.min.css' %}" rel="stylesheet">
      <script>
      $(document).ready(function(){
            $('#customer-info-table').DataTable( {
              "order": [],
              "columnDefs": [ {
                "targets"  : 'no-sort',
                "orderable": false,
                    }],
                  language: {
                      searchPlaceholder: "Search",
                      search: "",
                  }
                  });
      });
      </script>
      <script>
      $(".action").each(function () {
        $(this).modalForm({formURL: $(this).data('id')});
      });
      </script>

{% endblock content %}