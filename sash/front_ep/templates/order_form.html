{% load widget_tweaks %} {% load crispy_forms_tags %}
<div class="modal-header">
    <h5 class="modal-title">Order Now</h5>
    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
</div>

<div class="modal-body">
    <div class="content-section">
        <fieldset class="form-group">
            {{ form|crispy }}
            <div>
                <input type="checkbox"> I have read and agree to the Terms and Conditions and other important reminders and information posted by the company. I hereby confirm that Power Sash Enterprises reserves the right to refuse or cancel my order
                for any reason relating to my purchase in their sole discretion.</input>

            </div>
        </fieldset>
        <div class="modal-footer">
            <button class="submit btn btn-outline-primary" type="submit">Order Now</button>
        </div>
    </div>
</div>
<script>
    $('.submit').click(function() {
        $.ajax({
            url: "{% url 'create_customer_info' %}",
            method: 'POST',
            data: {
                csrfmiddlewaretoken: "{{ csrf_token }}",
                address: $('#id_address').val(),
                first_name: $('#id_first_name').val(),
                payment_method: $('#id_payment_method').val(),
                email: $('#id_email').val(),
                last_name: $('#id_last_name').val(),
                middle_initial: $('#id_middle_initial').val(),
                contact_number: $('#id_contact_number').val()
            },
            success: function(data){
                if (data['method']=="2"){
                    window.location.replace("{% url 'payment_process' %}");
                }
                else{
                    $('#modal').modal('toggle');
                    $('#alert_message').remove();
                    var alert_mes = "";
                    alert_mes += '<div id="alert_message" class="row alert alert-success animated fadeIn" role="alert">';
                    alert_mes += "<strong>Order successfully sent. We'll reach you out soon for validation!</strong></div>";
                    $('#cart_base').prepend(alert_mes);
                }
            }
        })
    })
</script>